<%- include('layout'); -%>

<!-- Section for displaying products -->
<section>
    <!-- Heading for the section -->
    <h2>Products</h2>

    <!-- Script to handle error message display and delete confirmation -->
    <script>
        // Check if there is an error message and show an alert
        const errorMessage = '<%= typeof error !== "undefined" ? error : "" %>';
        if (errorMessage) {
            alert(errorMessage);
        }

        // Function to handle the Delete link click
        function handleDeleteClick(event) {
            const confirmed = confirm('Are you sure you want to delete this product?');
            
            if (!confirmed) {
                event.preventDefault(); // Prevent the default behavior if not confirmed
            }
        }
    </script>

    <!-- Table for displaying product information -->
    <table border="1">
        <!-- Table header with column names -->
        <thead>
            <tr>
                <th>Product ID</th>
                <th>Description</th>
                <th>Store ID</th>
                <th>Location</th>
                <th>Price</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <!-- Loop through each product in the array and display their information -->
            <% products.forEach(product => { %>
                <tr>
                    <!-- Display product information in each row -->
                    <td><%= product.pid %></td>
                    <td><%= product.productdesc %></td>
                    <td><%= product.sid %></td>
                    <td><%= product.location %></td>
                    <td><%= product.price %></td>
                    <td>
                        <!-- Delete action link with confirmation alert -->
                        <a href="/products/delete/<%= product.pid %>" onclick="handleDeleteClick(event)">Delete</a>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>
</section>
