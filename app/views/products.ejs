<%- include('layout'); -%>

<section>
    <h2>Products</h2>
    <!-- Delete action link with confirmation alert, did it this way as when trying to get it to print to the screen with h tags it wouldn't work-->
    <script>
        // Check if there is an error message and show an alert
        const errorMessage = '<%= typeof error !== "undefined" ? error : "" %>';
        if (errorMessage) {
            alert(errorMessage);
        }

        // Function to handle the Delete link click
        function handleDeleteClick(event) {
            const confirmed = confirm('Are you sure you want to delete this product?');
            
            if (!confirmed) {
                event.preventDefault(); // Prevent the default behavior if not confirmed
            }
        }
    </script>
    <table border="1">
        <thead>
            <tr>
                <th>Product ID</th>
                <th>Description</th>
                <th>Store ID</th>
                <th>Location</th>
                <th>Price</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <% products.forEach(product => { %>
                <tr>
                    <td><%= product.pid %></td>
                    <td><%= product.productdesc %></td>
                    <td><%= product.sid %></td>
                    <td><%= product.location %></td>
                    <td><%= product.price %></td>
                    <td>
                        <!-- Delete action link with confirmation alert -->
                        <a href="/products/delete/<%= product.pid %>" onclick="handleDeleteClick(event)">Delete</a>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>
</section>
